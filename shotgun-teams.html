<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shotgun League - Season 5 Preview</title>
  <style>
    :root {
      --bg: #020617; --card-bg: #0b1120;
      --accent: #22c55e; --accent-soft: rgba(34, 197, 94, 0.2);
      --text-main: #e5e7eb; --text-muted: #9ca3af;
      --border-soft: rgba(148, 163, 184, 0.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#0f172a 0,#020617 55%);
      color:var(--text-main);
      display:flex;align-items:flex-start;justify-content:center;padding:2rem 1rem;
    }
    .container{width:100%;max-width:960px;display:flex;flex-direction:column;gap:2rem;}
    .section {
      border-radius:1.25rem;padding:1.25rem;background:var(--card-bg);
      border:1px solid var(--border-soft);
      box-shadow:0 18px 40px rgba(15,23,42,.85),0 0 0 1px rgba(15,23,42,.9);
      position:relative;
    }
    .section-title { font-size:1.1rem;font-weight:600;margin-bottom:.5rem; }
    .rows {
      margin-top:.75rem;border-radius:.9rem;background:rgba(15,23,42,.9);
      border:1px solid rgba(55,65,81,.9);padding:.4rem .6rem;
      max-height:480px;overflow-y:auto;
    }
    .row {
      display:grid;grid-template-columns:0.6fr 1fr 1fr;gap:.75rem;
      padding:.45rem .5rem;align-items:center;
      border-bottom:1px solid rgba(31,41,55,.9);font-size:.8rem;
    }
    .row-rank { display:inline-flex;gap:.4rem;font-weight:600; }
    .rank-pill {
      width:1.4rem;height:1.4rem;border-radius:999px;
      display:inline-flex;align-items:center;justify-content:center;
      border:1px solid rgba(148,163,184,.75);
      background:radial-gradient(circle at top,var(--accent-soft),rgba(15,23,42,.9));
    }
    .cell-value { font-variant-numeric:tabular-nums;text-align:right; }
    .loading { padding:.4rem;font-size:.85rem;color:var(--text-muted); }
    .error {
      padding:.4rem;font-size:.85rem;color:#fecaca;background:rgba(127,29,29,.4);
      border-radius:.6rem;border:1px solid rgba(248,113,113,.5);
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- Section 1: Teams -->
    <div class="section">
      <div class="section-title">Season 5 Team Standings</div>
      <div id="status-teams" class="loading">Fetching Team Standings…</div>
      <div class="rows" id="rows-teams" style="display:none;"></div>
    </div>

    <!-- Section 2: Top 10 Players -->
    <div class="section">
      <div class="section-title">Season 5 Top 10 Players</div>
      <div id="status-players" class="loading">Fetching Top Players…</div>
      <div class="rows" id="rows-players" style="display:none;"></div>
    </div>

  </div>

<script>
  const WORKER_URL = "https://small-mud-2771.nextweekmedia.workers.dev/";
  const SHEET_ID = "1qIM0HKhx9Y-3eCJCFzBqrbATwiPrK3C1ynATwZzRC1o";

  const RANGES = {
    teams: "Season 5!U4:X15",
    players: "Season 5!U18:X32"
  };

  async function fetchData(range) {
    const res = await fetch(`${WORKER_URL}?sheetId=${SHEET_ID}&range=${encodeURIComponent(range)}`);
    const json = await res.json();
    return json.values || [];
  }

  function render(list, containerId, statusId) {
    const container = document.getElementById(containerId);
    const status = document.getElementById(statusId);
    status.style.display = "none";
    container.style.display = "block";

    container.innerHTML = "";

    list.forEach(row => {
      const rank = row[0];
      const name = row[2];
      const score = row[3];
      if (!rank || !name) return;

      const rowEl = document.createElement("div");
      rowEl.className = "row";
      rowEl.innerHTML = `
        <div class="row-rank"><span class="rank-pill">${rank}</span>${name}</div>
        <div class="cell-value">${score ?? "–"}</div>
        <div class="cell-value"></div>
      `;
      container.appendChild(rowEl);
    });
  }

  async function init() {
    try {
      // Teams
      const teams = await fetchData(RANGES.teams);
      render(teams, "rows-teams", "status-teams");

      // Players
      const players = await fetchData(RANGES.players);
      render(players, "rows-players", "status-players");

    } catch (err) {
      console.error(err);
      document.getElementById("status-teams").className = "error";
      document.getElementById("status-teams").textContent = "Error loading teams.";
      document.getElementById("status-players").className = "error";
      document.getElementById("status-players").textContent = "Error loading players.";
    }
  }

  init();
</script>

</body>
</html>
