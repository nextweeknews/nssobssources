<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shotgun League - Season 5 Preview</title>
  <style>
    :root {
      --bg: #020617;
      --card-bg: #0b1120;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.2);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-soft: rgba(148, 163, 184, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%);
      color: var(--text-main);
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 2rem 1rem;
    }

    .container {
      width: 100%;
      max-width: 960px;
    }

    .header {
      margin-bottom: 1.5rem;
      padding: 1.25rem 1.5rem;
      border-radius: 1rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(15, 118, 110, 0.6));
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow:
        0 18px 45px rgba(0, 0, 0, 0.65),
        0 0 0 1px rgba(15, 23, 42, 0.8);
    }

    .header-title {
      font-size: 1.4rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: .6rem;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: .35rem;
      border-radius: 999px;
      padding: 0.1rem 0.7rem;
      font-size: .7rem;
      text-transform: uppercase;
      letter-spacing: .08em;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
    }

    .pill-dot {
      width: .45rem;
      height: .45rem;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.35);
    }

    .header-sub {
      margin-top: 0.4rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .embed-preview {
      border-radius: 1.25rem;
      padding: 1.25rem;
      background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.12), transparent 55%),
                  radial-gradient(circle at bottom right, rgba(59, 130, 246, 0.12), transparent 55%),
                  var(--card-bg);
      border: 1px solid var(--border-soft);
      box-shadow:
        0 18px 40px rgba(15, 23, 42, 0.85),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      position: relative;
      overflow: hidden;
    }

    .embed-accent {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: linear-gradient(to bottom, var(--accent), #16a34a);
    }

    .embed-header {
      margin-left: 0.75rem;
      margin-bottom: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }

    .embed-title {
      font-size: 1.05rem;
      font-weight: 600;
    }

    .embed-subtitle {
      font-size: .78rem;
      color: var(--text-muted);
    }

    .embed-badge {
      padding: 0.2rem 0.5rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.7rem;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .rows {
      margin-top: 0.75rem;
      border-radius: 0.9rem;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 0.4rem 0.6rem;
      max-height: 480px;
      overflow-y: auto;
    }

    .row {
      display: grid;
      grid-template-columns: 0.6fr repeat(3, minmax(0, 0.33fr));
      gap: 0.75rem;
      padding: 0.45rem 0.5rem;
      align-items: center;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      font-size: 0.8rem;
    }

    .row:last-child {
      border-bottom: none;
    }

    .row:hover {
      background: rgba(15, 23, 42, 0.9);
    }

    .row-rank {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-weight: 600;
    }

    .rank-pill {
      width: 1.4rem;
      height: 1.4rem;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.75);
      background: radial-gradient(circle at top, var(--accent-soft), rgba(15, 23, 42, 0.9));
    }

    .row-name {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .cell-label {
      display: none;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin-bottom: 0.1rem;
    }

    .cell-value {
      font-variant-numeric: tabular-nums;
    }

    .footer-note {
      margin-top: 0.6rem;
      font-size: 0.75rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .loading {
      padding: 0.8rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .error {
      padding: 0.8rem;
      font-size: 0.85rem;
      color: #fecaca;
      background: rgba(127, 29, 29, 0.4);
      border-radius: 0.6rem;
      border: 1px solid rgba(248, 113, 113, 0.5);
      margin-top: 0.5rem;
    }

    @media (max-width: 720px) {
      .row {
        grid-template-columns: 1.1fr repeat(3, minmax(0, 0.5fr));
        font-size: 0.78rem;
      }
    }

    @media (max-width: 560px) {
      .row {
        grid-template-columns: 1.5fr 1fr;
        grid-template-rows: auto auto auto;
        grid-auto-flow: row;
      }

      .row > div:nth-child(2),
      .row > div:nth-child(3),
      .row > div:nth-child(4) {
        display: flex;
        flex-direction: column;
      }

      .cell-label {
        display: block;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="pill">
        <span class="pill-dot"></span>
        Shotgun League ‚Ä¢ Season 5
      </div>
      <div class="header-title">
        Range Preview: <span style="opacity:.85;">Season 5!U4:X15</span>
      </div>
      <div class="header-sub">
        This is a visual mockup of how the Google Sheets data will appear when turned into a Discord-style embed.
      </div>
    </div>

    <div class="embed-preview">
      <div class="embed-accent"></div>

      <div class="embed-header">
        <div>
          <div class="embed-title">Season 5 Standings</div>
          <div class="embed-subtitle">Live from Google Sheets &mdash; range U4:X15</div>
        </div>
        <div class="embed-badge" id="row-count-badge">
          Loading rows‚Ä¶
        </div>
      </div>

      <div id="status" class="loading">Contacting Google Sheets‚Ä¶</div>
      <div class="rows" id="rows" style="display:none;"></div>

      <div class="footer-note">
        <span>üîÅ This layout is designed to map 1:1 into a Discord embed (title, description, fields).</span>
        <span id="updated-at"></span>
      </div>
    </div>
  </div>

  <script>
    // Google Visualization API endpoint for the published sheet
    const SHEET_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vTzXVDEZKX1OziMk4r1nthI6BjvI8IUCiXL_6RUKqLHGcRwvfRlzK8_1qJ6Uf26De26CHuvoSgPOomu/gviz/tq" +
      "?sheet=Season%205&range=U4:X15&tqx=out:json";

    async function fetchSheetRange() {
      const res = await fetch(SHEET_URL);
      const text = await res.text();

      // Google returns something like: google.visualization.Query.setResponse({...});
      const jsonStr = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
      return JSON.parse(jsonStr);
    }

    function renderData(data) {
      const rowsContainer = document.getElementById("rows");
      const status = document.getElementById("status");
      const rowCountBadge = document.getElementById("row-count-badge");
      const updatedAt = document.getElementById("updated-at");

      status.style.display = "none";
      rowsContainer.style.display = "block";

      const cols = (data.table.cols || []).map(c => c.label || "");
      const rows = (data.table.rows || []).map(r =>
        (r.c || []).map(c => (c && (c.formattedValue || c.v)) || "")
      );

      rowsContainer.innerHTML = "";

      let visibleRowCount = 0;

      rows.forEach((row, index) => {
        const isEmpty = row.every(cell => cell === "" || cell === null || typeof cell === "undefined");
        if (isEmpty) return;

        visibleRowCount++;

        const rowEl = document.createElement("div");
        rowEl.className = "row";

        const primaryName = row[0] || `Row ${index + 1}`;

        const rankCol = document.createElement("div");
        rankCol.className = "row-rank";
        rankCol.innerHTML = `
          <span class="rank-pill">${visibleRowCount}</span>
          <span class="row-name">${primaryName}</span>
        `;

        const makeStatCell = (label, value) => {
          const wrapper = document.createElement("div");

          const labelEl = document.createElement("div");
          labelEl.className = "cell-label";
          labelEl.textContent = label || "Stat";

          const valueEl = document.createElement("div");
          valueEl.className = "cell-value";
          valueEl.textContent = value === "" ? "‚Äì" : value;

          wrapper.appendChild(labelEl);
          wrapper.appendChild(valueEl);
          return wrapper;
        };

        const col2Label = cols[1] || "Col 2";
        const col3Label = cols[2] || "Col 3";
        const col4Label = cols[3] || "Col 4";

        rowEl.appendChild(rankCol);
        rowEl.appendChild(makeStatCell(col2Label, row[1]));
        rowEl.appendChild(makeStatCell(col3Label, row[2]));
        rowEl.appendChild(makeStatCell(col4Label, row[3]));

        rowsContainer.appendChild(rowEl);
      });

      rowCountBadge.textContent =
        visibleRowCount === 0
          ? "No rows in range"
          : `${visibleRowCount} row${visibleRowCount === 1 ? "" : "s"} loaded`;

      const now = new Date();
      updatedAt.textContent = `Last refreshed: ${now.toLocaleString()}`;
    }

    async function init() {
      const status = document.getElementById("status");

      try {
        status.textContent = "Fetching Season 5 range from Google Sheets‚Ä¶";
        const data = await fetchSheetRange();
        renderData(data);
      } catch (err) {
        console.error(err);
        status.className = "error";
        status.textContent =
          "Error loading data from Google Sheets. Check the browser console (F12) for details. " +
          "If this is blocked by CORS, you may need a tiny backend proxy.";
        document.getElementById("row-count-badge").textContent = "Error";
      }
    }

    init();
  </script>
</body>
</html>
